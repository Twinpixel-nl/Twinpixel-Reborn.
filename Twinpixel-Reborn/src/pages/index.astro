---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const site = Astro.site?.toString().replace(/\/$/, "") ?? "";

// Fetch latest NL posts (2x)
const posts = (await getCollection("posts", ({ data }) => data.lang === "nl"))
  .sort((a, b) => +new Date(b.data.date) - +new Date(a.data.date))
  .slice(0, 2);

// Fetch recent NL cases (up to 3x)
const cases = (await getCollection("cases", ({ data }) => data.lang === "nl"))
  .sort((a, b) => +new Date(b.data.date) - +new Date(a.data.date))
  .slice(0, 3);

// JSON-LD: LocalBusiness, WebSite (with SearchAction), BreadcrumbList
const jsonLd = [
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "TwinPixel",
    "url": `${site}/`,
    "potentialAction": {
      "@type": "SearchAction",
      "target": `${site}/blog/?q={search_term_string}`,
      "query-input": "required name=search_term_string"
    }
  },
  {
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "name": "TwinPixel",
    "url": `${site}/`,
    "image": `${site}/favicon.svg`,
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Wageningen",
      "addressRegion": "Gelderland",
      "addressCountry": "NL"
    },
    "areaServed": "Wageningen, Gelderland, Netherlands",
    "sameAs": [
      "https://www.linkedin.com/company/twinpixel",
      "https://github.com/Twinpixel-nl"
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": `${site}/`
      }
    ]
  }
];
---

<BaseLayout
  title="Webdesign in Wageningen"
  description="Snelle, professionele websites voor ZZP en MKB. Maatwerk, helder, SEO-sterk. Vraag een offerte aan."
  lang="nl"
  canonical="/"
  alternates={{ nl: "/", en: "/en/" }}
  xDefaultAlternate="/"
  transparentHeader={true}
  jsonLd={jsonLd}
>
  <!-- Hero -->
  <section class="relative isolate overflow-hidden">
    <picture>
      <source
        type="image/avif"
        srcset="/images/hero-1920.avif 1920w, /images/hero-1280.avif 1280w"
        sizes="(min-width: 1024px) 100vw, 100vw" />
      <source
        type="image/webp"
        srcset="/images/DSC00511.webp 1920w, /images/hero-1280.webp 1280w"
        sizes="(min-width: 1024px) 100vw, 100vw" />
      <img
        src="/images/hero-1280.webp"
        alt="Twan en collega overleggen over websitecode bij TwinPixel"
        width="1920"
        height="1080"
        class="w-full h-[60vh] md:h-[70vh] object-cover"
        loading="eager"
        decoding="async"
        fetchpriority="high" />
    </picture>
    <div class="absolute inset-0 bg-gradient-to-t from-slate-950/70 to-slate-900/10"></div>

    <div class="container relative z-10 py-16 md:py-24">
      <h1 class="text-4xl md:text-5xl font-semibold tracking-tight">Webdesign in Wageningen.</h1>
      <p class="prose mt-4 text-slate-200">
        Snelle, professionele websites die duidelijk zijn en overtuigen.
      </p>
      <div class="mt-6 flex flex-wrap gap-3">
        <a href="/contact/" class="btn-primary" aria-label="Offerte aanvragen">Offerte aanvragen</a>
        <a href="/portfolio/" class="underline underline-offset-4 decoration-slate-600 hover:text-cyan-400" aria-label="Bekijk portfolio">Bekijk portfolio</a>
      </div>
    </div>
  </section>

  <!-- USP strip -->
  <section class="py-8 border-y" style="border-color: var(--color-border-subtle);">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 text-slate-200 text-sm">
      <div class="flex items-center gap-2">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 12h18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>
        Snel online
      </div>
      <div class="flex items-center gap-2">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 7h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7Zm4 0V5a4 4 0 1 1 8 0v2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        100% maatwerk
      </div>
      <div class="flex items-center gap-2">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 12l6 6L21 6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        SEO-technisch sterk
      </div>
      <div class="flex items-center gap-2">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 20a8 8 0 1 0-8-8 8 8 0 0 0 8 8Z" stroke="currentColor" stroke-width="1.6"/><path d="M9.5 10a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0ZM15.5 10a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0ZM8 14s2 2 4 2 4-2 4-2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Persoonlijk & duidelijk
      </div>
    </div>
  </section>

  <!-- Diensten -->
  <section class="section">
    <h2>Diensten</h2>
    <div class="mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      <a href="/diensten/" class="card p-5 h-full flex flex-col">
        <h3>Webdesign</h3>
        <ul class="mt-3 text-slate-300 list-disc ms-5 space-y-1">
          <li>Heldere structuur en copy</li>
          <li>Toegankelijk en mobiel-vriendelijk</li>
          <li>Core Web Vitals top</li>
        </ul>
        <span class="mt-4 text-cyan-400">Meer over Webdesign →</span>
      </a>
      <a href="/diensten/" class="card p-5 h-full flex flex-col">
        <h3>SEO</h3>
        <ul class="mt-3 text-slate-300 list-disc ms-5 space-y-1">
          <li>Technische basis op orde</li>
          <li>Slimme interne links</li>
          <li>Scherpe metadata</li>
        </ul>
        <span class="mt-4 text-cyan-400">Meer over SEO →</span>
      </a>
      <a href="/diensten/" class="card p-5 h-full flex flex-col">
        <h3>Onderhoud & Hosting</h3>
        <ul class="mt-3 text-slate-300 list-disc ms-5 space-y-1">
          <li>Veilig en up-to-date</li>
          <li>Vaste, transparante kosten</li>
          <li>Regie zonder gedoe</li>
        </ul>
        <span class="mt-4 text-cyan-400">Meer over onderhoud →</span>
      </a>
    </div>
  </section>

  <!-- Recente cases -->
  <section class="section">
    <div class="flex items-end justify-between gap-4">
      <h2>Recente cases</h2>
      <a href="/portfolio/" class="text-cyan-400 text-sm hover:text-cyan-300">Alle cases →</a>
    </div>
    <div class="mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {cases.length === 0 && (
        <p class="text-slate-400">Binnenkort echte projecten. We vullen hier lokale cases aan.</p>
      )}
      {cases.map((c) => {
        const cover = c.data.cover || "/uploads/placeholder.webp";
        const resultLine = (c.data.results && c.data.results[0]) || c.data.description;
        return (
          <a href={`/portfolio/${c.slug}/`} class="card overflow-hidden">
            <div class="relative" style="aspect-ratio: 16/10;">
              <img src={cover} alt={`Case: ${c.data.title}`} class="absolute inset-0 h-full w-full object-cover" loading="lazy" decoding="async" />
            </div>
            <div class="p-5">
              <h3 class="text-lg font-semibold">{c.data.title}</h3>
              {resultLine && <p class="text-slate-300 mt-2">{resultLine}</p>}
            </div>
          </a>
        );
      })}
    </div>
  </section>

  <!-- Blog -->
  <section class="section">
    <div class="flex items-end justify-between gap-4">
      <h2>Blog</h2>
      <a href="/blog/" class="text-cyan-400 text-sm hover:text-cyan-300">Alle artikelen →</a>
    </div>
    <div class="mt-6 grid gap-6 sm:grid-cols-2">
      {posts.length === 0 && (
        <p class="text-slate-400">Binnenkort artikelen over webdesign, SEO en onderhoud.</p>
      )}
      {posts.map((post) => (
        <a href={`/blog/${post.slug}/`} class="card p-5 block">
          <h3 class="text-lg font-semibold">{post.data.title}</h3>
          {post.data.description && <p class="text-slate-300 mt-2">{post.data.description}</p>}
          <p class="text-slate-500 text-sm mt-3">{new Date(post.data.date).toLocaleDateString("nl-NL")}</p>
        </a>
      ))}
    </div>
  </section>

  <!-- CTA band -->
  <section aria-labelledby="cta-title" class="section">
    <div class="rounded-2xl border" style="border-color: var(--color-border-subtle);">
      <div class="p-6 sm:p-8 md:p-10">
        <h2 id="cta-title" class="tracking-tight">Samen werken aan jouw website?</h2>
        <p class="prose mt-3 text-slate-300">Plan een korte call of vraag direct een offerte aan.</p>
        <div class="mt-5 flex flex-wrap gap-3">
          <a href="/contact/" class="btn-primary" aria-label="Offerte aanvragen">Offerte aanvragen</a>
          <a href="/contact/" class="underline underline-offset-4 decoration-slate-600 hover:text-cyan-400">Contact</a>
        </div>
      </div>
    </div>
  </section>

  <!-- SEO micro line -->
  <section class="pt-4 pb-10">
    <p class="text-sm text-slate-500">
      TwinPixel bouwt snelle, vindbare websites in Wageningen voor ZZP en MKB.
    </p>
  </section>
</BaseLayout>
